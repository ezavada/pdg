<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- custom header for pdg js docs -->
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Pixel Dust Game Engine: NetServer Class Reference</title>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen_js.css" rel="stylesheet" type="text/css" />
<link href="editor.css" rel="stylesheet" type="text/css"/>
<!-- block added for inline editing support -->
<script type="text/javascript" src="Markdown.Converter.js"></script>
<script type="text/javascript" src="Markdown.Sanitizer.js"></script>
<script type="text/javascript" src="Markdown.DoxyConverter.js"></script>
<script type="text/javascript" src="Markdown.Editor.js"></script>
<script type="text/javascript" src="Markdown.DoxyEditor.js"></script>
<!-- end of block added for inline editing support -->
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
   <div id="projectlogo"><img alt="Logo" src="banner_logo.jpg"/></div>
   <div id="projectname">Pixel Dust Game Engine&#160;<span id="projectnumber">v0.9.4</span>
   </div>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.2 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacepdg.html">pdg</a></li><li class="navelem"><a class="el" href="classpdg_1_1_net_server.html">NetServer</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="classpdg_1_1_net_server-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">NetServer Class Reference<div class="ingroups"><a class="el" href="group___network.html">Networking</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>a network endpoint that can accept incoming connections  
 <a href="classpdg_1_1_net_server.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:aa08e2b25ccdaddbe6b701b36c10a82b5"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpdg_1_1_net_server.html#aa08e2b25ccdaddbe6b701b36c10a82b5">NetServer</a> (object opts=null)</td></tr>
<tr class="memdesc:aa08e2b25ccdaddbe6b701b36c10a82b5"><td class="mdescLeft">&#160;</td><td class="mdescRight">constructor for a <a class="el" href="classpdg_1_1_net_server.html" title="a network endpoint that can accept incoming connections">NetServer</a>, sets server options  <a href="#aa08e2b25ccdaddbe6b701b36c10a82b5"></a><br/></td></tr>
<tr class="separator:aa08e2b25ccdaddbe6b701b36c10a82b5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:accb87e866fd6cc3832f6c89baecf42e8"><td class="memItemLeft" align="right" valign="top">number&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpdg_1_1_net_server.html#accb87e866fd6cc3832f6c89baecf42e8">broadcast</a> (object message, function filter=null)</td></tr>
<tr class="memdesc:accb87e866fd6cc3832f6c89baecf42e8"><td class="mdescLeft">&#160;</td><td class="mdescRight">send a message to all connected clients  <a href="#accb87e866fd6cc3832f6c89baecf42e8"></a><br/></td></tr>
<tr class="separator:accb87e866fd6cc3832f6c89baecf42e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5c94bf1db5265290eae4a2b274c1aaed"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classpdg_1_1_net_server.html">NetServer</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpdg_1_1_net_server.html#a5c94bf1db5265290eae4a2b274c1aaed">expectClient</a> (string clientKey, string clientIpAddr= '*', int reservationTTL=FOREVER, boolean singleUse=false)</td></tr>
<tr class="memdesc:a5c94bf1db5265290eae4a2b274c1aaed"><td class="mdescLeft">&#160;</td><td class="mdescRight">make a connection reservation for a client  <a href="#a5c94bf1db5265290eae4a2b274c1aaed"></a><br/></td></tr>
<tr class="separator:a5c94bf1db5265290eae4a2b274c1aaed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a85afcea7117e5d349d223183e45f7b4c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classpdg_1_1_net_server.html">NetServer</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpdg_1_1_net_server.html#a85afcea7117e5d349d223183e45f7b4c">listen</a> (function callback)</td></tr>
<tr class="memdesc:a85afcea7117e5d349d223183e45f7b4c"><td class="mdescLeft">&#160;</td><td class="mdescRight">listen and call a function when new connections are established  <a href="#a85afcea7117e5d349d223183e45f7b4c"></a><br/></td></tr>
<tr class="separator:a85afcea7117e5d349d223183e45f7b4c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abcc944ff48dfb471890ad2f6a924f086"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classpdg_1_1_net_server.html">NetServer</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpdg_1_1_net_server.html#abcc944ff48dfb471890ad2f6a924f086">onError</a> (function callback)</td></tr>
<tr class="memdesc:abcc944ff48dfb471890ad2f6a924f086"><td class="mdescLeft">&#160;</td><td class="mdescRight">set up callback for handling errors  <a href="#abcc944ff48dfb471890ad2f6a924f086"></a><br/></td></tr>
<tr class="separator:abcc944ff48dfb471890ad2f6a924f086"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9d07b0851a40af56ecf9a4e8d4e8bd5f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpdg_1_1_net_server.html#a9d07b0851a40af56ecf9a4e8d4e8bd5f">shutdown</a> (boolean closeExisting=true, boolean kill=false)</td></tr>
<tr class="memdesc:a9d07b0851a40af56ecf9a4e8d4e8bd5f"><td class="mdescLeft">&#160;</td><td class="mdescRight">stop listening for new connections  <a href="#a9d07b0851a40af56ecf9a4e8d4e8bd5f"></a><br/></td></tr>
<tr class="separator:a9d07b0851a40af56ecf9a4e8d4e8bd5f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5558c5d549f41597377fa1ea8a1cefa3"><td class="memItemLeft" align="right" valign="top">string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpdg_1_1_net_server.html#a5558c5d549f41597377fa1ea8a1cefa3">toString</a> ()</td></tr>
<tr class="memdesc:a5558c5d549f41597377fa1ea8a1cefa3"><td class="mdescLeft">&#160;</td><td class="mdescRight">returns "[object NetServer]"  <a href="#a5558c5d549f41597377fa1ea8a1cefa3"></a><br/></td></tr>
<tr class="separator:a5558c5d549f41597377fa1ea8a1cefa3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:a88ec2e71106f83a754776a47843573cb"><td class="memItemLeft" align="right" valign="top">boolean&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpdg_1_1_net_server.html#a88ec2e71106f83a754776a47843573cb">allowDatagram</a></td></tr>
<tr class="memdesc:a88ec2e71106f83a754776a47843573cb"><td class="mdescLeft">&#160;</td><td class="mdescRight">when true, the server tries to establish UDP communications with the client  <a href="#a88ec2e71106f83a754776a47843573cb"></a><br/></td></tr>
<tr class="separator:a88ec2e71106f83a754776a47843573cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a05c97c0ecc629abbb582b61ed0bfc9b3"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpdg_1_1_net_server.html#a05c97c0ecc629abbb582b61ed0bfc9b3">connections</a></td></tr>
<tr class="memdesc:a05c97c0ecc629abbb582b61ed0bfc9b3"><td class="mdescLeft">&#160;</td><td class="mdescRight">an array of NetConnections made to this server - <b>Read Only</b>  <a href="#a05c97c0ecc629abbb582b61ed0bfc9b3"></a><br/></td></tr>
<tr class="separator:a05c97c0ecc629abbb582b61ed0bfc9b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ffaf6e3a228ef910002506cc4ccdd22"><td class="memItemLeft" align="right" valign="top">number&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpdg_1_1_net_server.html#a0ffaf6e3a228ef910002506cc4ccdd22">handshakeTimeout</a></td></tr>
<tr class="memdesc:a0ffaf6e3a228ef910002506cc4ccdd22"><td class="mdescLeft">&#160;</td><td class="mdescRight">the number of milliseconds allowed for handshake. Default is 5000 (5 seconds)  <a href="#a0ffaf6e3a228ef910002506cc4ccdd22"></a><br/></td></tr>
<tr class="separator:a0ffaf6e3a228ef910002506cc4ccdd22"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4cae57894e508c9a74535cd8f0c11f1a"><td class="memItemLeft" align="right" valign="top">boolean&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpdg_1_1_net_server.html#a4cae57894e508c9a74535cd8f0c11f1a">listening</a></td></tr>
<tr class="memdesc:a4cae57894e508c9a74535cd8f0c11f1a"><td class="mdescLeft">&#160;</td><td class="mdescRight">flag to indicate if the server is currently listening or not  <a href="#a4cae57894e508c9a74535cd8f0c11f1a"></a><br/></td></tr>
<tr class="separator:a4cae57894e508c9a74535cd8f0c11f1a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a208a500bff1e92ba66b90411d7418ae0"><td class="memItemLeft" align="right" valign="top">boolean&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpdg_1_1_net_server.html#a208a500bff1e92ba66b90411d7418ae0">reservationRequired</a></td></tr>
<tr class="memdesc:a208a500bff1e92ba66b90411d7418ae0"><td class="mdescLeft">&#160;</td><td class="mdescRight">flag to indicate if reservations to the server are required or not  <a href="#a208a500bff1e92ba66b90411d7418ae0"></a><br/></td></tr>
<tr class="separator:a208a500bff1e92ba66b90411d7418ae0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af014438d56d0675fe3bc066ccb941500"><td class="memItemLeft" align="right" valign="top">string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpdg_1_1_net_server.html#af014438d56d0675fe3bc066ccb941500">serverAddr</a></td></tr>
<tr class="memdesc:af014438d56d0675fe3bc066ccb941500"><td class="mdescLeft">&#160;</td><td class="mdescRight">the address (interface) on which the server listens 0.0.0.0 means all interfaces on the computer  <a href="#af014438d56d0675fe3bc066ccb941500"></a><br/></td></tr>
<tr class="separator:af014438d56d0675fe3bc066ccb941500"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a87077d7e45375c78fff735d5f5addba8"><td class="memItemLeft" align="right" valign="top">number&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpdg_1_1_net_server.html#a87077d7e45375c78fff735d5f5addba8">serverPort</a></td></tr>
<tr class="memdesc:a87077d7e45375c78fff735d5f5addba8"><td class="mdescLeft">&#160;</td><td class="mdescRight">the port on which the server listens  <a href="#a87077d7e45375c78fff735d5f5addba8"></a><br/></td></tr>
<tr class="separator:a87077d7e45375c78fff735d5f5addba8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>a network endpoint that can accept incoming connections </p>
<dl class="section note"><dt>Note</dt><dd><b>API Stability: 2 - Unstable</b>. The API is in the process of settling, but has not yet had sufficient real-world testing to be considered stable. Backwards-compatibility will be maintained if reasonable.</dd></dl>
<h2>Overview</h2>
<p><a class="el" href="classpdg_1_1_net_server.html" title="a network endpoint that can accept incoming connections">NetServer</a> is part of the PDG Engine's custom protocol for games. It handles protocol negotiation and optional connections. It provide a server that listens for connections with a client over both TCP (reliable transport with guaranteed delivery) and UDP (small and unreliable but fast).</p>
<p><a class="el" href="classpdg_1_1_net_server.html" title="a network endpoint that can accept incoming connections">NetServer</a> doesn't actually handle network communication, it only listens for incoming connections. Once a connection is established, it creates a <a class="el" href="classpdg_1_1_net_connection.html" title="sends data between two network endpoints">NetConnection</a> object for each connected client that you can use to send and receive data.</p>
<p>In cases where your server consists of multiple processes (most game servers do, especially ones that expect to scale to handle a large number of users) a particular server process may be both a server and a client. For example, it might accept connections from players over the internet using a <a class="el" href="classpdg_1_1_net_server.html" title="a network endpoint that can accept incoming connections">NetServer</a>, but then connect (using a <a class="el" href="classpdg_1_1_net_client.html" title="a network endpoint that can initiate a connection">NetClient</a>) to a central message distribution system to relay chat between players connected to different server nodes.</p>
<h2>Authorization &amp; Reservations</h2>
<p>There are 5 different ways you can allow clients to connect:</p>
<ol type="1">
<li><b>Wide Open</b> - clients do not require any authorization or reservation to connect. Obviously this is the least secure, but is fine for server processes that are all behind a firewall, or peer to peer connections. This is the default setting for <a class="el" href="classpdg_1_1_net_server.html" title="a network endpoint that can accept incoming connections">NetServer</a> if no options are used.</li>
<li><b>Common Key</b> - clients all send the same static key. To do this, call <a class="el" href="classpdg_1_1_net_server.html#a5c94bf1db5265290eae4a2b274c1aaed" title="make a connection reservation for a client">expectClient()</a> once with the static key and no other parameters. That will allow all clients to call <a class="el" href="classpdg_1_1_net_client.html#a90d598df2dacf49b5d4737dc14b6351d" title="establish a connection to a server">NetClient.connect()</a> with that static key. Attempts to connect without the key will be rejected by the <a class="el" href="classpdg_1_1_net_server.html" title="a network endpoint that can accept incoming connections">NetServer</a></li>
<li><b>Computed Key</b> - clients and server each compute a key based on some common information that they all have, most likely the UTC date/time. This is nearly the same as a static key, except that the single key doesn't last forever. To do this, all <a class="el" href="classpdg_1_1_net_server.html#a5c94bf1db5265290eae4a2b274c1aaed" title="make a connection reservation for a client">expectClient()</a> with the new key at a regular interval and set a reservationTTL for the keys. Make sure you pass "*" (any ip) for the clientIPAddr. You will probably want the TTL to be slightly longer than the new key interval to give clients a little extra time to connect with the previous computed key, to allow for differences in date/time between different systems.</li>
<li><b>Per-Client reservation</b> - Each client gets a unique key for their exclusive use during a session, set on the server side by calling <a class="el" href="classpdg_1_1_net_server.html#a5c94bf1db5265290eae4a2b274c1aaed" title="make a connection reservation for a client">expectClient()</a>. Generally this happens when the user logs in. This is made stronger if the client's IP address is also part of the reservation. The reservation should have a time to live (TTL).</li>
<li><b>Single Use Reservation</b> - This is by far the most secure, especially when combined with IP address checking. Any time the client is going to connect to a server, it must be given a key, and the server must be told to expect that key using <a class="el" href="classpdg_1_1_net_server.html#a5c94bf1db5265290eae4a2b274c1aaed" title="make a connection reservation for a client">expectClient()</a>. TTL should be short (10s of seconds) and the singleUse flag should be passed as true to <a class="el" href="classpdg_1_1_net_server.html#a5c94bf1db5265290eae4a2b274c1aaed" title="make a connection reservation for a client">expectClient()</a>.</li>
</ol>
<dl class="section warning"><dt>Warning</dt><dd><a class="el" href="classpdg_1_1_net_client.html" title="a network endpoint that can initiate a connection">NetClient</a>, <a class="el" href="classpdg_1_1_net_server.html" title="a network endpoint that can accept incoming connections">NetServer</a>, and <a class="el" href="classpdg_1_1_net_connection.html" title="sends data between two network endpoints">NetConnection</a> all work together over a custom protocol. <a class="el" href="classpdg_1_1_net_server.html" title="a network endpoint that can accept incoming connections">NetServer</a> doesn't handle raw TCP nor any other protocol such as HTTP. There are perfectly fine <a href="http://nodejs.org/api/net.html">Net</a> and <a href="http://nodejs.org/api/http.html">HTTP</a> modules built-in to Node.js (and thus to PDG) for that.</dd></dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="classpdg_1_1_net_server.html#a5c94bf1db5265290eae4a2b274c1aaed" title="make a connection reservation for a client">expectClient</a> </dd>
<dd>
<a class="el" href="classpdg_1_1_net_connection.html" title="sends data between two network endpoints">NetConnection</a> </dd>
<dd>
<a class="el" href="classpdg_1_1_net_client.html" title="a network endpoint that can initiate a connection">NetClient</a> </dd>
<dd>
<a href="http://nodejs.org/api/net.html">Node.js Net module</a> </dd>
<dd>
<a href="http://nodejs.org/api/http.html">Node.js HTTP module</a> </dd></dl>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="aa08e2b25ccdaddbe6b701b36c10a82b5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classpdg_1_1_net_server.html">NetServer</a> </td>
          <td>(</td>
          <td class="paramtype">object&#160;</td>
          <td class="paramname"><em>opts</em> = <code>null</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>constructor for a <a class="el" href="classpdg_1_1_net_server.html" title="a network endpoint that can accept incoming connections">NetServer</a>, sets server options </p>
<p>Construct a new <a class="el" href="classpdg_1_1_net_server.html" title="a network endpoint that can accept incoming connections">NetServer</a> with particular options or using default values if no options are specified.</p>
<p>Available options are:</p>
<ol type="1">
<li>serverAddr - a string with the IP address (or hostname), defaults to 0.0.0.0 (all interfaces)</li>
<li>serverPort - a string with the port to use (defaults to 5000)</li>
<li>fixedPort - if false, indicate if we should try sequential ports if the one we asked for is already in use (defaults to false)</li>
<li>noDatagram - flag to indicate that we should not try to establish UDP communication with the client (defaults to false)</li>
<li>reservationRequired - flag indicating whether clients must be authenticated or not (defaults to false)</li>
<li>handshakeTimeout - number of milliseconds to wait for handshake to complete. Connection is killed if handshake not complete by that time. Default is 5000 (5 seconds). Shorter times offer better protection against Denial of Service attacks.</li>
</ol>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">opts</td><td>a Javascript object with the options above</td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line">var myServer = <span class="keyword">new</span> pdg.NetServer( { <a class="code" href="classpdg_1_1_net_server.html#a87077d7e45375c78fff735d5f5addba8" title="the port on which the server listens">serverPort</a>: 6160, noDatagram = <span class="keyword">true</span> } );</div>
</div><!-- fragment --> 
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="accb87e866fd6cc3832f6c89baecf42e8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">broadcast </td>
          <td>(</td>
          <td class="paramtype">object&#160;</td>
          <td class="paramname"><em>message</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">function&#160;</td>
          <td class="paramname"><em>filter</em> = <code>null</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>send a message to all connected clients </p>
<p>Go through all the NetConnections in the connections array send the message to each of them. If a filter function is used, instead of sending to all, only send to the ones that filter function returns true for.</p>
<p>The filter function should take one parameter, a Net Connection, and should return true if the connection passes the filter, and false if it is excluded by the filter.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">message</td><td>the message to send </td></tr>
    <tr><td class="paramname">filter</td><td>the filter function. If not passed, all connections will be sent the message.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the number of connections that were actually sent a message </dd></dl>

</div>
</div>
<a class="anchor" id="a5c94bf1db5265290eae4a2b274c1aaed"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">expectClient </td>
          <td>(</td>
          <td class="paramtype">string&#160;</td>
          <td class="paramname"><em>clientKey</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">string&#160;</td>
          <td class="paramname"><em>clientIpAddr</em> = <code>'*'</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>reservationTTL</em> = <code>FOREVER</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">boolean&#160;</td>
          <td class="paramname"><em>singleUse</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>make a connection reservation for a client </p>
<p>When a server is created with the reservationRequired flag set to true, the server needs to know how clients are authorized. Use this to make specific reservations for clients by unique key and/or IP address; or a general reservation for all clients using a shared key, perhaps computed based on UTC date and time.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">clientKey</td><td>- the key the client(s) must provide </td></tr>
    <tr><td class="paramname">clientIpAddr</td><td>- the IP address the client is allowed to connect from (defaults to '*', which means any IP address will be accepted) </td></tr>
    <tr><td class="paramname">reservationTTL</td><td>- how long this reservation is valid (defaults to forever) </td></tr>
    <tr><td class="paramname">singleUse</td><td>- flag to indicate if the reservation becomes invalid after it is used (default to false, can be used multiple times until expiration)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>itself for call chaining </dd></dl>

</div>
</div>
<a class="anchor" id="a85afcea7117e5d349d223183e45f7b4c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">listen </td>
          <td>(</td>
          <td class="paramtype">function&#160;</td>
          <td class="paramname"><em>callback</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>listen and call a function when new connections are established </p>
<p>Starts a listening port for incoming connections, and with each new connection calls the provided callback with a newly created <a class="el" href="classpdg_1_1_net_connection.html" title="sends data between two network endpoints">NetConnection</a>.</p>
<p>The callback will be invoked with one parameter, a <a class="el" href="classpdg_1_1_net_connection.html" title="sends data between two network endpoints">NetConnection</a>.</p>
<div class="fragment"><div class="line">myServer.listen( <span class="keyword">function</span>(myConnection) {</div>
<div class="line">    myConnection.send(<span class="stringliteral">&#39;sorry, too busy to talk&#39;</span>);</div>
<div class="line">    myConnection.close();</div>
<div class="line">});</div>
</div><!-- fragment --><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">callback</td><td>the callback function</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>itself for call chaining</dd></dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="classpdg_1_1_net_connection.html" title="sends data between two network endpoints">NetConnection</a> </dd></dl>

</div>
</div>
<a class="anchor" id="abcc944ff48dfb471890ad2f6a924f086"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">onError </td>
          <td>(</td>
          <td class="paramtype">function&#160;</td>
          <td class="paramname"><em>callback</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>set up callback for handling errors </p>
<p>These will be errors with the listening port, not with the connections themselves; those go to the connection object. The exception is IP mismatch on incoming connections &ndash; those don't generate any errors to avoid spending unnecessary resources in the event of denial of service attacks.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">callback</td><td>the callback function to be notified of errors</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>itself for call chaining </dd></dl>

</div>
</div>
<a class="anchor" id="a9d07b0851a40af56ecf9a4e8d4e8bd5f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">shutdown </td>
          <td>(</td>
          <td class="paramtype">boolean&#160;</td>
          <td class="paramname"><em>closeExisting</em> = <code>true</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">boolean&#160;</td>
          <td class="paramname"><em>kill</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>stop listening for new connections </p>
<p>This will also do a clean shutdown of all existing connections made through it, unless you tell it not to by passing false for closeExisting.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">closeExisting</td><td>flag for whether existing connections should be closed or not (defaults to true if not passed) </td></tr>
    <tr><td class="paramname">kill</td><td>flag for whether existing connections should be killed. True means kill, false means allow to drain normally (defaults to false if not passed).</td></tr>
  </table>
  </dd>
</dl>
<p>This will also do a clean shutdown of all existing connections made through it, unless you tell it not to by passing false for closeExisting.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">closeExisting</td><td>flag for whether existing connections should be closed or not (defaults to true if not passed) </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a5558c5d549f41597377fa1ea8a1cefa3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">toString </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>returns "[object NetServer]" </p>
<p>(<em>Waves hand</em>) This is not the method you are looking for.</p>
<p>You probably want this:</p>
<div class="fragment"><div class="line"><span class="keyword">function</span> getServerString(ns) {</div>
<div class="line">    <span class="keywordflow">return</span> <span class="stringliteral">&quot;NetServer@&quot;</span> + ns.serverAddr + <span class="stringliteral">&quot;:&quot;</span> + ns.serverPort;</div>
<div class="line">}</div>
</div><!-- fragment --><p>Which gives something like this: </p>
<pre class="fragment">NetServer@127.0.0.1:5000</pre> 
</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a class="anchor" id="a88ec2e71106f83a754776a47843573cb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">allowDatagram</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>when true, the server tries to establish UDP communications with the client </p>
<p>This is set based on what you pass in for noDatagram at <a class="el" href="classpdg_1_1_net_server.html" title="a network endpoint that can accept incoming connections">NetServer</a> initialization. It can be changed at any time to affect new incoming connections. Changes will not affect existing connections. </p>

</div>
</div>
<a class="anchor" id="a05c97c0ecc629abbb582b61ed0bfc9b3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">connections</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>an array of NetConnections made to this server - <b>Read Only</b> </p>

</div>
</div>
<a class="anchor" id="a0ffaf6e3a228ef910002506cc4ccdd22"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">handshakeTimeout</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>the number of milliseconds allowed for handshake. Default is 5000 (5 seconds) </p>
<p>The connection will be dropped if handshake has not completed in this time. This is to help prevent denial of service attacks.</p>
<p>This can be changed at any time to affect the timeout for new incoming connections. Changes will not affect existing connections.</p>
<p>The connection will be dropped if handshake has not completed in this time. This is to help prevent denial of service attacks. </p>

</div>
</div>
<a class="anchor" id="a4cae57894e508c9a74535cd8f0c11f1a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">listening</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>flag to indicate if the server is currently listening or not </p>
<p>flag to indicate if the server is currently listening or not - <b>Read Only</b> </p>

</div>
</div>
<a class="anchor" id="a208a500bff1e92ba66b90411d7418ae0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">reservationRequired</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>flag to indicate if reservations to the server are required or not </p>
<p>This can be changed at any time to affect new incoming connection. Changes will not affect existing connections. </p>

</div>
</div>
<a class="anchor" id="af014438d56d0675fe3bc066ccb941500"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">serverAddr</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>the address (interface) on which the server listens 0.0.0.0 means all interfaces on the computer </p>
<p>the address (interface) on which the server listens</p>
<p>This can be changed at any time <em>before</em> calling <a class="el" href="classpdg_1_1_net_server.html#a85afcea7117e5d349d223183e45f7b4c" title="listen and call a function when new connections are established">listen()</a>. It should be considered Read Only after calling <a class="el" href="classpdg_1_1_net_server.html#a85afcea7117e5d349d223183e45f7b4c" title="listen and call a function when new connections are established">listen()</a>.</p>
<p>0.0.0.0 means all interfaces on the computer </p>

</div>
</div>
<a class="anchor" id="a87077d7e45375c78fff735d5f5addba8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">serverPort</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>the port on which the server listens </p>
<p>This can be changed at any time <em>before</em> calling <a class="el" href="classpdg_1_1_net_server.html#a85afcea7117e5d349d223183e45f7b4c" title="listen and call a function when new connections are established">listen()</a>. It should be considered Read Only after calling <a class="el" href="classpdg_1_1_net_server.html#a85afcea7117e5d349d223183e45f7b4c" title="listen and call a function when new connections are established">listen()</a>. </p>

</div>
</div>
</div><!-- contents -->
<div class="contents">
	<h2 class="groupheader">User Comments</h2>
	<div id="disqus_thread"></div>
</div>
<script type="text/javascript">
var disqus_shortname = 'pdgdocs';
(function() {
	var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
	dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
	(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> and a whole mess of custom scripts.
</small></address>
</body>
</html>
